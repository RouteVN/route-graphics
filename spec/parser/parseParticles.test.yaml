file: "../../src/plugins/elements/particles/parseParticles.js"
group: parser
suites: [parseParticles]
---
suite: parseParticles
exportName: parseParticles
---
case: Test parsing particles with full custom config (Level 3)
in:
  - state:
      id: "sparkles"
      type: "particles"
      width: 1280
      height: 720
      texture:
        shape: circle
        radius: 5
        color: "#ffffff"
      behaviors:
        - type: "spawnShape"
          config:
            type: "rect"
            data:
              x: 0
              y: 0
              w: 1280
              h: 720
        - type: "alpha"
          config:
            list:
              - value: 0
                time: 0
              - value: 1
                time: 0.2
              - value: 0
                time: 1
      emitter:
        lifetime:
          min: 0.5
          max: 1.0
        frequency: 0.1
        maxParticles: 50
out:
  id: "sparkles"
  type: "particles"
  count: 50
  width: 1280
  height: 720
  texture:
    shape: circle
    radius: 5
    color: "#ffffff"
  behaviors:
    - type: "spawnShape"
      config:
        type: "rect"
        data:
          x: 0
          y: 0
          w: 1280
          h: 720
    - type: "alpha"
      config:
        list:
          - value: 0
            time: 0
          - value: 1
            time: 0.2
          - value: 0
            time: 1
  emitter:
    lifetime:
      min: 0.5
      max: 1.0
    frequency: 0.1
    maxParticles: 50
  x: 0
  y: 0
  alpha: 1
---
case: Error when id is missing
in:
  - state:
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
      emitter:
        maxParticles: 50
throws: "Input Error: Id is missing"
---
case: Error when width or height is missing
in:
  - state:
      id: "no-dimensions"
      type: "particles"
      texture: "circle"
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
      emitter:
        maxParticles: 50
throws: "Input Error: Particles require both width and height"
---
case: Error when texture is not provided
in:
  - state:
      id: "no-texture"
      type: "particles"
      width: 1280
      height: 720
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
      emitter:
        maxParticles: 50
throws: "Input Error: Particles require 'texture'"
---
case: Error when behaviors is not provided
in:
  - state:
      id: "no-behaviors"
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      emitter:
        maxParticles: 50
throws: "Input Error: Particles require 'behaviors'"
---
case: Error when behaviors is not an array
in:
  - state:
      id: "invalid-behaviors"
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      behaviors: "not-an-array"
      emitter:
        maxParticles: 50
throws: "Input Error: 'behaviors' must be an array"
---
case: Error when behaviors array is empty
in:
  - state:
      id: "empty-behaviors"
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      behaviors: []
      emitter:
        maxParticles: 50
throws: "Input Error: 'behaviors' array cannot be empty"
---
case: Error when emitter is not provided
in:
  - state:
      id: "no-emitter"
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
throws: "Input Error: Particles require 'emitter'"
---
case: Error when emitter is not an object
in:
  - state:
      id: "invalid-emitter"
      type: "particles"
      width: 1280
      height: 720
      texture: "circle"
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
      emitter: "not-an-object"
throws: "Input Error: 'emitter' must be an object"
---
case: Error when width is missing
in:
  - state:
      id: "no-width"
      type: "particles"
      height: 720
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
              - value: 0
                time: 1
throws: "Input Error: Particles require both width and height"
---
case: Error when height is missing
in:
  - state:
      id: "no-height"
      type: "particles"
      width: 1280
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
              - value: 0
                time: 1
throws: "Input Error: Particles require both width and height"
---
case: Error when both width and height are missing
in:
  - state:
      id: "no-dimensions"
      type: "particles"
      behaviors:
        - type: "alpha"
          config:
            list:
              - value: 1
                time: 0
              - value: 0
                time: 1
throws: "Input Error: Particles require both width and height"
